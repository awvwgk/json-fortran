<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="JSON-Fortran â€“ A Modern Fortran JSON API">
    <meta name="author" content="Jacob Williams" >
    <link rel="icon" href="../favicon.png">

    <title>json_value_validate &ndash; JSON-Fortran</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
      <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->

         <script src="../js/jquery-2.1.3.min.js"></script>
         <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">JSON-Fortran </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
              <li><a href='../page/index.html'>Other Docs</a></li>
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
                 data-toggle="dropdown" role="button"
                 aria-haspopup="true"
                 aria-expanded="false">
                 Contents <span class="caret"></span>
              </a>
              <ul class="dropdown-menu">
                    <li><a href="../lists/files.html">Source Files</a></li>
                  <li><a href="../lists/modules.html">Modules</a></li>
                  <li><a href="../lists/procedures.html">Procedures</a></li>
                  <li><a href="../lists/absint.html">Abstract Interfaces</a></li>
                  <li><a href="../lists/types.html">Derived Types</a></li>
              </ul>
            </li>
                <li class="visible-xs hidden-sm visible-lg">
                  <a href="../lists/files.html">Source Files</a>
                </li>
              <li class="visible-xs hidden-sm visible-lg">
                <a href="../lists/modules.html">Modules</a>
              </li>
              <li class="visible-xs hidden-sm visible-lg">
                <a href="../lists/procedures.html">Procedures</a>
              </li>
              <li class="visible-xs hidden-sm visible-lg">
                <a href="../lists/absint.html">Abstract Interfaces</a>
              </li>
              <li class="visible-xs hidden-sm visible-lg">
                <a href="../lists/types.html">Derived Types</a>
              </li>
          </ul>
            <form action="../search.html" class="navbar-form navbar-right" role="search">
              <div class="form-group">
                <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
              </div>
              <!--
                  <button type="submit" class="btn btn-default">Submit</button>
                  -->
            </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>json_value_validate
      <small>Subroutine</small>
      
    </h1>
      <div class="row" id="info-bar">
    <div class="col-lg-12">
      <div class="well well-sm">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">
            <li id="meta-author"><i class="fa fa-pencil"></i> Jacob Williams</li>
            <li id="meta-date"><i class="fa fa-calendar-o"></i> 5/2/2016</li>

          <li id="statements"><i class="fa fa-list-ol"></i>
            <a data-toggle="tooltip"
               data-placement="bottom" data-html="true"
               title=" 2.6% of total for procedures.">180 statements</a>
          </li>

            <li id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/json_value_module.F90"> Source File</a>
            </li>
        </ul>
        <ol class="breadcrumb in-well text-right">
              <li><a href='../sourcefile/json_value_module.f90.html'>json_value_module.F90</a></li>
              <li><a href='../module/json_value_module.html'>json_value_module</a></li>
          <li class="active">json_value_validate</li>
        </ol>
      </div>
    </div>
  </div>
  <script>
    $(function () {
    $('[data-toggle="tooltip"]').tooltip()
    })
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="panel panel-primary">
      <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../proc/json_value_validate.html#src">json_value_validate</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>private  subroutine json_value_validate(json, p, is_valid, error_msg)  
</h2>
    

    <p>Validate a <a href="../type/json_value.html">json_value</a> linked list by checking to make sure
  all the pointers are properly associated, arrays and objects
  have the correct number of children, and the correct data is
  allocated for the variable types.</p>
<p>It recursively traverses the entire structure and checks every element.</p>
<h3 id="history">History</h3>
<ul>
<li>Jacob Williams, 8/26/2017 : added duplicate key check.</li>
</ul>
<p></p><div class="alert alert-info" role="alert"><h4>Note</h4><p>It will return on the first error it encounters.</p></div>
<p></p><div class="alert alert-info" role="alert"><h4>Note</h4><p>This routine does not check or throw any exceptions.
      If <code>json</code> is currently in a state of exception, it will
      remain so after calling this routine.</p></div>

    <h3>Type Bound</h3>
    <p><a href='../type/json_core.html'>json_core</a></p>

    <h3>Arguments</h3>
        <table class="table table-striped varlist">
    <thead>
      <tr>
        <th>Type</th>
<th>Intent</th><th>Optional</th>        <th>Attributes</th>
        <th></th>
        <th>Name</th>
        <th></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-json~204"></span>
              class(<a href='../type/json_core.html'>json_core</a>),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>json</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-p~127"></span>
              type(<a href='../type/json_value.html'>json_value</a>),
            </td>
<td>intent(in),</td>
              <td></td>            <td>
              pointer
            </td>
            <td>::</td>
            <td><strong>p</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-is_valid"></span>
              logical(kind=LK),
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>is_valid</strong></td>
            <td>
                <p>True if the structure is valid.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-error_msg~2"></span>
              character(kind=CK, len=:),
            </td>
<td>intent(out),</td>
              <td></td>            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>error_msg</strong></td>
            <td>
                <p>if not valid, this will contain
a description of the problem</p>
            </td>
        </tr>
    </tbody>
  </table>

    <br>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~json_value_validate~~CallsGraph Pages: 1 -->
<svg id="procjson_value_validateCallsGraph" width="478pt" height="200pt"
 viewBox="0.00 0.00 478.00 200.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~json_value_validate~~CallsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 196)">
<title>proc~~json_value_validate~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-196 474,-196 474,4 -4,4"/>
<!-- proc~json_value_validate -->
<g id="proc~~json_value_validate~~CallsGraph_node1" class="node">
<title>proc~json_value_validate</title>
<polygon fill="none" stroke="black" points="286,-108 0,-108 0,-84 286,-84 286,-108"/>
<text text-anchor="middle" x="143" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50">json_value_module::json_core%json_value_validate</text>
</g>
<!-- check_for_duplicate_keys -->
<g id="proc~~json_value_validate~~CallsGraph_node2" class="node">
<title>check_for_duplicate_keys</title>
<polygon fill="#777777" stroke="#777777" points="470,-192 322,-192 322,-168 470,-168 470,-192"/>
<text text-anchor="middle" x="396" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_for_duplicate_keys</text>
</g>
<!-- proc~json_value_validate&#45;&gt;check_for_duplicate_keys -->
<g id="proc~~json_value_validate~~CallsGraph_edge1" class="edge">
<title>proc~json_value_validate&#45;&gt;check_for_duplicate_keys</title>
<path fill="none" stroke="#255000" d="M176.28,-108.08C211.79,-121.22 270.65,-142.54 322,-159 328.41,-161.06 335.17,-163.13 341.88,-165.12"/>
<polygon fill="#255000" stroke="#255000" points="341.06,-168.53 351.64,-167.99 343.03,-161.81 341.06,-168.53"/>
</g>
<!-- check_for_errors -->
<g id="proc~~json_value_validate~~CallsGraph_node3" class="node">
<title>check_for_errors</title>
<polygon fill="#777777" stroke="#777777" points="446.5,-150 345.5,-150 345.5,-126 446.5,-126 446.5,-150"/>
<text text-anchor="middle" x="396" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_for_errors</text>
</g>
<!-- proc~json_value_validate&#45;&gt;check_for_errors -->
<g id="proc~~json_value_validate~~CallsGraph_edge2" class="edge">
<title>proc~json_value_validate&#45;&gt;check_for_errors</title>
<path fill="none" stroke="#255000" d="M215.93,-108.04C253.64,-114.35 299.29,-121.98 335.06,-127.97"/>
<polygon fill="#255000" stroke="#255000" points="334.91,-131.49 345.35,-129.69 336.06,-124.59 334.91,-131.49"/>
</g>
<!-- clear_exceptions -->
<g id="proc~~json_value_validate~~CallsGraph_node4" class="node">
<title>clear_exceptions</title>
<polygon fill="#777777" stroke="#777777" points="447,-108 345,-108 345,-84 447,-84 447,-108"/>
<text text-anchor="middle" x="396" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">clear_exceptions</text>
</g>
<!-- proc~json_value_validate&#45;&gt;clear_exceptions -->
<g id="proc~~json_value_validate~~CallsGraph_edge3" class="edge">
<title>proc~json_value_validate&#45;&gt;clear_exceptions</title>
<path fill="none" stroke="#255000" d="M286,-96C303.13,-96 319.83,-96 334.82,-96"/>
<polygon fill="#255000" stroke="#255000" points="334.9,-99.5 344.9,-96 334.9,-92.5 334.9,-99.5"/>
</g>
<!-- failed -->
<g id="proc~~json_value_validate~~CallsGraph_node5" class="node">
<title>failed</title>
<polygon fill="#777777" stroke="#777777" points="423,-66 369,-66 369,-42 423,-42 423,-66"/>
<text text-anchor="middle" x="396" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">failed</text>
</g>
<!-- proc~json_value_validate&#45;&gt;failed -->
<g id="proc~~json_value_validate~~CallsGraph_edge4" class="edge">
<title>proc~json_value_validate&#45;&gt;failed</title>
<path fill="none" stroke="#255000" d="M215.93,-83.96C262.67,-76.14 321.62,-66.28 358.82,-60.05"/>
<polygon fill="#255000" stroke="#255000" points="359.43,-63.5 368.71,-58.4 358.27,-56.6 359.43,-63.5"/>
</g>
<!-- throw_exception -->
<g id="proc~~json_value_validate~~CallsGraph_node6" class="node">
<title>throw_exception</title>
<polygon fill="#777777" stroke="#777777" points="445.5,-24 346.5,-24 346.5,0 445.5,0 445.5,-24"/>
<text text-anchor="middle" x="396" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">throw_exception</text>
</g>
<!-- proc~json_value_validate&#45;&gt;throw_exception -->
<g id="proc~~json_value_validate~~CallsGraph_edge5" class="edge">
<title>proc~json_value_validate&#45;&gt;throw_exception</title>
<path fill="none" stroke="#255000" d="M176.28,-83.92C211.79,-70.78 270.65,-49.46 322,-33 328.41,-30.94 335.17,-28.87 341.88,-26.88"/>
<polygon fill="#255000" stroke="#255000" points="343.03,-30.19 351.64,-24.01 341.06,-23.47 343.03,-30.19"/>
</g>
</g>
</svg>
</div>        <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
          <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                </div>
              <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="597pt" height="32pt"
 viewBox="0.00 0.00 596.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 592.5,-28 592.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="388.5,-24 243.5,-24 243.5,0 388.5,0 388.5,-24"/>
<text text-anchor="middle" x="316" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="465,-24 407,-24 407,0 465,0 465,-24"/>
<text text-anchor="middle" x="436" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="588.5,-24 483.5,-24 483.5,0 588.5,0 588.5,-24"/>
<text text-anchor="middle" x="536" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.
</p>
 Where possible, edges connecting nodes are
given different colours to make them easier to distinguish in
large graphs.</div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <br>

    <section class="visible-xs visible-sm hidden-md">
        <h3>Contents</h3>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="panel panel-primary">
      <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../proc/json_value_validate.html#src">json_value_validate</a>
      </div>
    </div>


    </section>
    <br class="visible-xs visible-sm hidden-md">


    
    

    
    


    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span><span class="w">    </span><span class="k">subroutine </span><span class="n">json_value_validate</span><span class="p">(</span><span class="n">json</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">is_valid</span><span class="p">,</span><span class="n">error_msg</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="k">implicit none</span>

<span class="k">    class</span><span class="p">(</span><span class="n">json_core</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w">      </span><span class="kd">::</span><span class="w"> </span><span class="n">json</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">json_value</span><span class="p">),</span><span class="k">pointer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">p</span><span class="w"></span>
<span class="w">    </span><span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w">             </span><span class="kd">::</span><span class="w"> </span><span class="n">is_valid</span><span class="w">  </span><span class="c">!! True if the structure is valid.</span>
<span class="w">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span><span class="k">allocatable</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">error_msg</span><span class="w"> </span><span class="c">!! if not valid, this will contain</span>
<span class="w">                                                                  </span><span class="c">!! a description of the problem</span>

<span class="w">    </span><span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">has_duplicate</span><span class="w"> </span><span class="c">!! to check for duplicate keys</span>
<span class="w">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">path</span><span class="w">  </span><span class="c">!! path to duplicate key</span>
<span class="w">    </span><span class="kt">logical</span><span class="p">(</span><span class="n">LK</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">status_ok</span><span class="w"> </span><span class="c">!! to check for existing exception</span>
<span class="w">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">exception_msg</span><span class="w">  </span><span class="c">!! error message for an existing exception</span>
<span class="w">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">CK</span><span class="p">,</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">exception_msg2</span><span class="w">  </span><span class="c">!! error message for a new exception</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">associated</span><span class="p">(</span><span class="n">p</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>

<span class="k">        </span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span><span class="w"></span>
<span class="w">        </span><span class="k">call </span><span class="n">check_if_valid</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">require_parent</span><span class="o">=</span><span class="nb">associated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">parent</span><span class="p">))</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">is_valid</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">json</span><span class="p">%</span><span class="n">allow_duplicate_keys</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"></span>
<span class="w">            </span><span class="c">! if no errors so far, also check the</span>
<span class="w">            </span><span class="c">! entire structure for duplicate keys:</span>

<span class="w">            </span><span class="c">! note: check_for_duplicate_keys does call routines</span>
<span class="w">            </span><span class="c">! that check and throw exceptions, so let&#39;s clear any</span>
<span class="w">            </span><span class="c">! first. (save message for later)</span>
<span class="w">            </span><span class="k">call </span><span class="n">json</span><span class="p">%</span><span class="n">check_for_errors</span><span class="p">(</span><span class="n">status_ok</span><span class="p">,</span><span class="w"> </span><span class="n">exception_msg</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">call </span><span class="n">json</span><span class="p">%</span><span class="n">clear_exceptions</span><span class="p">()</span><span class="w"></span>

<span class="w">            </span><span class="k">call </span><span class="n">json</span><span class="p">%</span><span class="n">check_for_duplicate_keys</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">has_duplicate</span><span class="p">,</span><span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">json</span><span class="p">%</span><span class="n">failed</span><span class="p">())</span><span class="w"> </span><span class="k">then</span><span class="w"></span>
<span class="w">                </span><span class="c">! if an exception was thrown during this call,</span>
<span class="w">                </span><span class="c">! then clear it but make that the error message</span>
<span class="w">                </span><span class="c">! returned by this routine. Normally this should</span>
<span class="w">                </span><span class="c">! never actually occur since we have already</span>
<span class="w">                </span><span class="c">! validated the structure.</span>
<span class="w">                </span><span class="k">call </span><span class="n">json</span><span class="p">%</span><span class="n">check_for_errors</span><span class="p">(</span><span class="n">is_valid</span><span class="p">,</span><span class="w"> </span><span class="n">exception_msg2</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="n">error_msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">exception_msg2</span><span class="w"></span>
<span class="w">                </span><span class="k">call </span><span class="n">json</span><span class="p">%</span><span class="n">clear_exceptions</span><span class="p">()</span><span class="w"></span>
<span class="w">                </span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="w">            </span><span class="k">else</span>
<span class="k">                if</span><span class="w"> </span><span class="p">(</span><span class="n">has_duplicate</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    </span><span class="n">error_msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;duplicate key found: &#39;</span><span class="o">//</span><span class="n">path</span><span class="w"></span>
<span class="w">                    </span><span class="n">is_valid</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="w">                </span><span class="k">end if</span>
<span class="k">            end if</span>

<span class="k">            if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">status_ok</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"></span>
<span class="w">                </span><span class="c">! restore any existing exception if necessary</span>
<span class="w">                </span><span class="k">call </span><span class="n">json</span><span class="p">%</span><span class="n">throw_exception</span><span class="p">(</span><span class="n">exception_msg</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">end if</span><span class="w"></span>

<span class="w">            </span><span class="c">! cleanup:</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">path</span><span class="p">))</span><span class="w">           </span><span class="k">deallocate</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">exception_msg</span><span class="p">))</span><span class="w">  </span><span class="k">deallocate</span><span class="p">(</span><span class="n">exception_msg</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">exception_msg2</span><span class="p">))</span><span class="w"> </span><span class="k">deallocate</span><span class="p">(</span><span class="n">exception_msg2</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">end if</span>

<span class="k">    else</span>
<span class="k">        </span><span class="n">error_msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;The pointer is not associated&#39;</span><span class="w"></span>
<span class="w">        </span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="w">    </span><span class="k">end if</span>

<span class="k">    contains</span>

<span class="k">    recursive subroutine </span><span class="n">check_if_valid</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">require_parent</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">implicit none</span>

<span class="k">        type</span><span class="p">(</span><span class="n">json_value</span><span class="p">),</span><span class="k">pointer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">p</span><span class="w"></span>
<span class="w">        </span><span class="kt">logical</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">require_parent</span><span class="w"> </span><span class="c">!! the first one may be a root (so no parent),</span>
<span class="w">                                             </span><span class="c">!! but all descendants must have a parent.</span>

<span class="w">        </span><span class="kt">integer</span><span class="p">(</span><span class="n">IK</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="c">!! counter</span>
<span class="w">        </span><span class="k">type</span><span class="p">(</span><span class="n">json_value</span><span class="p">),</span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">element</span><span class="w"></span>
<span class="w">        </span><span class="k">type</span><span class="p">(</span><span class="n">json_value</span><span class="p">),</span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">previous</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">is_valid</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="nb">associated</span><span class="p">(</span><span class="n">p</span><span class="p">))</span><span class="w"> </span><span class="k">then</span><span class="w"></span>

<span class="w">            </span><span class="c">! data type:</span>
<span class="w">            </span><span class="k">select case</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">var_type</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">case</span><span class="p">(</span><span class="n">json_null</span><span class="p">,</span><span class="n">json_object</span><span class="p">,</span><span class="n">json_array</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">log_value</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">int_value</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                    </span><span class="nb">allocated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">dbl_value</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">str_value</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    </span><span class="n">error_msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;incorrect data allocated for &#39;</span><span class="o">//</span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                                </span><span class="s1">&#39;json_null, json_object, or json_array variable type&#39;</span><span class="w"></span>
<span class="w">                    </span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="w">                    </span><span class="k">return</span>
<span class="k">                end if</span>
<span class="k">            case</span><span class="p">(</span><span class="n">json_logical</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">log_value</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    </span><span class="n">error_msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;log_value should be allocated for json_logical variable type&#39;</span><span class="w"></span>
<span class="w">                    </span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="w">                    </span><span class="k">return</span>
<span class="k">                else if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">int_value</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                    </span><span class="nb">allocated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">dbl_value</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">str_value</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    </span><span class="n">error_msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;incorrect data allocated for json_logical variable type&#39;</span><span class="w"></span>
<span class="w">                    </span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="w">                    </span><span class="k">return</span>
<span class="k">                end if</span>
<span class="k">            case</span><span class="p">(</span><span class="n">json_integer</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">int_value</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    </span><span class="n">error_msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;int_value should be allocated for json_integer variable type&#39;</span><span class="w"></span>
<span class="w">                    </span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="w">                    </span><span class="k">return</span>
<span class="k">                else if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">log_value</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                    </span><span class="nb">allocated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">dbl_value</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">str_value</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    </span><span class="n">error_msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;incorrect data allocated for json_integer variable type&#39;</span><span class="w"></span>
<span class="w">                    </span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="w">                    </span><span class="k">return</span>
<span class="k">                end if</span>
<span class="k">            case</span><span class="p">(</span><span class="n">json_real</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">dbl_value</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    </span><span class="n">error_msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;dbl_value should be allocated for json_real variable type&#39;</span><span class="w"></span>
<span class="w">                    </span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="w">                    </span><span class="k">return</span>
<span class="k">                else if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">log_value</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">int_value</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                    </span><span class="nb">allocated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">str_value</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    </span><span class="n">error_msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;incorrect data allocated for json_real variable type&#39;</span><span class="w"></span>
<span class="w">                    </span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="w">                    </span><span class="k">return</span>
<span class="k">                end if</span>
<span class="k">            case</span><span class="p">(</span><span class="n">json_string</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">str_value</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    </span><span class="n">error_msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;str_value should be allocated for json_string variable type&#39;</span><span class="w"></span>
<span class="w">                    </span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="w">                    </span><span class="k">return</span>
<span class="k">                else if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">log_value</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">int_value</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                    </span><span class="nb">allocated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">dbl_value</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    </span><span class="n">error_msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;incorrect data allocated for json_string variable type&#39;</span><span class="w"></span>
<span class="w">                    </span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="w">                    </span><span class="k">return</span>
<span class="k">                end if</span>
<span class="k">            case </span><span class="n">default</span><span class="w"></span>
<span class="w">                </span><span class="n">error_msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;invalid JSON variable type&#39;</span><span class="w"></span>
<span class="w">                </span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="w">                </span><span class="k">return</span>
<span class="k">            end select</span>

<span class="k">            if</span><span class="w"> </span><span class="p">(</span><span class="n">require_parent</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="nb">associated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">parent</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">                </span><span class="n">error_msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;parent pointer is not associated&#39;</span><span class="w"></span>
<span class="w">                </span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="w">                </span><span class="k">return</span>
<span class="k">            end if</span>

<span class="k">            if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">name</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">                if</span><span class="w"> </span><span class="p">(</span><span class="nb">associated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">parent</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    if</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">parent</span><span class="p">%</span><span class="n">var_type</span><span class="o">/=</span><span class="n">json_array</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                        </span><span class="n">error_msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;JSON variable must have a name if not an &#39;</span><span class="o">//</span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                                    </span><span class="s1">&#39;array element or the root&#39;</span><span class="w"></span>
<span class="w">                        </span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="w">                        </span><span class="k">return</span>
<span class="k">                    end if</span>
<span class="k">                end if</span>
<span class="k">            end if</span>

<span class="k">            if</span><span class="w"> </span><span class="p">(</span><span class="nb">associated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">children</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="n">neqv</span><span class="p">.</span><span class="w"> </span><span class="nb">associated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">tail</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">                </span><span class="n">error_msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;both children and tail pointers must be associated&#39;</span><span class="w"></span>
<span class="w">                </span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="w">                </span><span class="k">return</span>
<span class="k">            end if</span><span class="w"></span>

<span class="w">            </span><span class="c">! now, check next one:</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">associated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">next</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">                if</span><span class="w"> </span><span class="p">(</span><span class="nb">associated</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">p</span><span class="p">%</span><span class="n">next</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    </span><span class="n">error_msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;circular linked list&#39;</span><span class="w"></span>
<span class="w">                    </span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="w">                    </span><span class="k">return</span>
<span class="k">                else</span><span class="w"></span>
<span class="w">                    </span><span class="c">! if it&#39;s an element in an</span>
<span class="w">                    </span><span class="c">! array, then require a parent:</span>
<span class="w">                    </span><span class="k">call </span><span class="n">check_if_valid</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">next</span><span class="p">,</span><span class="n">require_parent</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span><span class="w"></span>
<span class="w">                </span><span class="k">end if</span>
<span class="k">            end if</span>

<span class="k">            if</span><span class="w"> </span><span class="p">(</span><span class="nb">associated</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">children</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>

<span class="k">                if</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">var_type</span><span class="o">/=</span><span class="n">json_array</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">p</span><span class="p">%</span><span class="n">var_type</span><span class="o">/=</span><span class="n">json_object</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    </span><span class="n">error_msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;only arrays and objects can have children&#39;</span><span class="w"></span>
<span class="w">                    </span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="w">                    </span><span class="k">return</span>
<span class="k">                end if</span><span class="w"></span>

<span class="w">                </span><span class="c">! first validate children pointers:</span>

<span class="w">                </span><span class="n">previous</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="nb">null</span><span class="p">()</span><span class="w"></span>
<span class="w">                </span><span class="n">element</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">p</span><span class="p">%</span><span class="n">children</span><span class="w"></span>
<span class="w">                </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1_IK</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">%</span><span class="n">n_children</span><span class="w"></span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="nb">associated</span><span class="p">(</span><span class="n">element</span><span class="p">%</span><span class="n">parent</span><span class="p">,</span><span class="n">p</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">                        </span><span class="n">error_msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;child&#39;&#39;s parent pointer not properly associated&#39;</span><span class="w"></span>
<span class="w">                        </span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="w">                        </span><span class="k">return</span>
<span class="k">                    end if</span>
<span class="k">                    if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="o">==</span><span class="mi">1</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="nb">associated</span><span class="p">(</span><span class="n">element</span><span class="p">%</span><span class="n">previous</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">                        </span><span class="n">error_msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;first child shouldn&#39;&#39;t have a previous&#39;</span><span class="w"></span>
<span class="w">                        </span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="w">                        </span><span class="k">return</span>
<span class="k">                    end if</span>
<span class="k">                    if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="o">&lt;</span><span class="n">p</span><span class="p">%</span><span class="n">n_children</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="nb">associated</span><span class="p">(</span><span class="n">element</span><span class="p">%</span><span class="n">next</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">                        </span><span class="n">error_msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;not enough children&#39;</span><span class="w"></span>
<span class="w">                        </span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="w">                        </span><span class="k">return</span>
<span class="k">                    end if</span>
<span class="k">                    if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="o">==</span><span class="n">p</span><span class="p">%</span><span class="n">n_children</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="nb">associated</span><span class="p">(</span><span class="n">element</span><span class="p">%</span><span class="n">next</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">                        </span><span class="n">error_msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;too many children&#39;</span><span class="w"></span>
<span class="w">                        </span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="w">                        </span><span class="k">return</span>
<span class="k">                    end if</span>
<span class="k">                    if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                        if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="nb">associated</span><span class="p">(</span><span class="n">previous</span><span class="p">,</span><span class="n">element</span><span class="p">%</span><span class="n">previous</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">                            </span><span class="n">error_msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;previous pointer not properly associated&#39;</span><span class="w"></span>
<span class="w">                            </span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="w">                            </span><span class="k">return</span>
<span class="k">                        end if</span>
<span class="k">                    end if</span>
<span class="k">                    if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="o">==</span><span class="n">p</span><span class="p">%</span><span class="n">n_children</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                        </span><span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="nb">associated</span><span class="p">(</span><span class="n">element</span><span class="p">%</span><span class="n">parent</span><span class="p">%</span><span class="n">tail</span><span class="p">,</span><span class="n">element</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">                        </span><span class="n">error_msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;parent&#39;&#39;s tail pointer not properly associated&#39;</span><span class="w"></span>
<span class="w">                        </span><span class="n">is_valid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="w">                        </span><span class="k">return</span>
<span class="k">                    end if</span>
<span class="k">                    if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="o">&lt;</span><span class="n">p</span><span class="p">%</span><span class="n">n_children</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"></span>
<span class="w">                        </span><span class="c">!setup next case:</span>
<span class="w">                        </span><span class="n">previous</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">element</span><span class="w"></span>
<span class="w">                        </span><span class="n">element</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">element</span><span class="p">%</span><span class="n">next</span><span class="w"></span>
<span class="w">                    </span><span class="k">end if</span>
<span class="k">                end do</span><span class="w"></span>

<span class="w">                </span><span class="c">!now check all the children:</span>
<span class="w">                </span><span class="k">call </span><span class="n">check_if_valid</span><span class="p">(</span><span class="n">p</span><span class="p">%</span><span class="n">children</span><span class="p">,</span><span class="n">require_parent</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span><span class="w"></span>

<span class="w">            </span><span class="k">end if</span>

<span class="k">        end if</span>

<span class="k">    end subroutine </span><span class="n">check_if_valid</span><span class="w"></span>

<span class="w">    </span><span class="k">end subroutine </span><span class="n">json_value_validate</span><span class="w"></span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row">
          <div class="col-xs-6 col-md-6"><p>JSON-Fortran was developed by Jacob Williams<br>&copy; 2023 
</p>
          </div>
          <div class="col-xs-6 col-md-6">
            <p class="text-right">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2023-06-26 23:30              </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript
         ================================================== -->
         <!-- Placed at the end of the document so the pages load faster -->
    <!--
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
        -->
        <script src="../js/bootstrap.min.js"></script>
        <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
        <script src="../js/ie10-viewport-bug-workaround.js"></script>

        <!-- MathJax JavaScript
             ================================================== -->
             <!-- Placed at the end of the document so the pages load faster -->
        <script type="text/x-mathjax-config">
          MathJax.Hub.Config({
          TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
          jax: ['input/TeX','input/MathML','output/HTML-CSS'],
          extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
          });
        </script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

          <script src="../tipuesearch/tipuesearch_content.js"></script>
          <script src="../tipuesearch/tipuesearch_set.js"></script>
          <script src="../tipuesearch/tipuesearch.js"></script>

  </body>
</html>